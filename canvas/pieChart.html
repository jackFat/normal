<!--
 * @Author: your name
 * @Date: 2020-02-03 21:30:43
 * @LastEditTime : 2020-02-03 22:28:11
 * @LastEditors  : Please set LastEditors
 * @Description: In User Settings Edit
 * @FilePath: \canvas\pieChart.html
 -->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Document</title>
</head>
<body>
  <canvas id="myCanvas"></canvas>

  <script>
    (
      function() {
        var canvas = document.querySelector('#myCanvas')
        var ctx = canvas.getContext('2d');
        var valueObj = [
          {
            value: .3,
            color: 'red',
            title: '苹果'
          },
          {
            value: .1,
            color: 'pink',
            title: '橘子'
          },
          {
            value: .2,
            color: 'blue',
            title: '香蕉'
          },
          {
            value: .3,
            color: 'green',
            title: '茄子'
          },
          {
            value: .1,
            color: 'gray',
            title: '西瓜'
          },
        ]

        canvas.width = 600
        canvas.height = 600
        canvas.style.border = '1px solid #000'

        var tempAngle = -90
        var radius = 200
        var x0 = 300
        var y0 = 300

        for(var i=0; i<valueObj.length; i++) {
          ctx.beginPath()
          ctx.moveTo(x0, y0)
          var angle = valueObj[i].value * 360
          ctx.fillStyle = valueObj[i].color
          var startAngle = tempAngle * Math.PI / 180
          var endAngle = (tempAngle + angle) * Math.PI / 180
          ctx.arc(x0, y0, radius, startAngle, endAngle)
          // var tit = valueObj[i].value * 100 + '%'
          var tit = valueObj[i].title
          var x, y
          var txtAngle = tempAngle + 1/2 * angle
          if (txtAngle > 90 && txtAngle < 270) {
            ctx.textAlign='end'
            
          }
          x = x0 + Math.cos(txtAngle * Math.PI / 180) * (radius + 20)
          y = y0 + Math.sin(txtAngle * Math.PI / 180) * (radius + 20)
          ctx.fillText(tit, x, y)
          ctx.fill()
          tempAngle += angle
        }
      }
    )()
    
  </script>
</body>
</html>